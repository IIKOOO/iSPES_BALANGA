<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Accounts</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-primary py-0 mb-2 sticky-top">
        <div class="container-fluid">
          <!--<a href=""><img class="m-0" style="height: 50px; width: 50px;" src="{{ url_for ('static', filename='images/peso_balanga_logo.png') }}" alt="Logo"></a>-->
          <a class="navbar-brand" href="{{url_for('index')}}"><img class="m-0" style="height: 40px; width: 40px;" src="{{ url_for('static', filename='images/spes_logo.png') }}" alt="Logo"></a> 
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="{{ url_for('login.login_admin') }}">Admin Dashboard</a>
              </li>
            </ul>
          </div>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="row g3 text-center mb-2">
            <div class="col-md-4">
                <a href="{{ url_for('admin.admin_adminAcc') }}" class="btn btn-success btn-lg w-100 border border-dark">Admin Accounts</a>
            </div>
            <div class="col-md-4">
                <a href="{{ url_for('admin.admin_studentAcc') }}" class="btn btn-info btn-lg w-100 border border-dark">Student Accounts</a>
            </div>
            <div class="col-md-4">
                <a href="{{ url_for('admin.admin_pesoAcc') }}" class="btn btn-info btn-lg w-100 border border-dark">Peso Accounts</a>
            </div>
        </div>
    </div>
    <div class="admin_container">
        <div class="left_side m-1 border rounded">
          <div class="p-2 d-flex justify-content-between align-items-center">
            <div>
              <h2 class="text-center" style="font-weight: bold;">Admin Accounts</h2>
            </div>
            <div class="input-group" style="width: 400px; margin-left: auto;">
                <div class="me-1">
                    <select id="adminFilterStatus" class="form-select">
                    <option value="all">All</option>
                    <option value="active">Active</option>
                    <option value="inactive">Inactive</option>
                    </select>
                </div> 
                <input id="adminSearchInput" class="form-control border-primary rounded-start-2" type="search" placeholder="Search by name" aria-label="Search">
            </div>
          </div>
          <div style="max-height: 820px; overflow-y: auto;">
            <table class="table table-secondary table-striped">
              <thead class="table-dark sticky-top">
                  <tr>
                      <th>ID</th>
                      <th>Last Name</th>
                      <th>First Name</th>
                      <th>Birth Date</th>
                      <th>Gender</th>
                      <th>Role</th>
                      <th>Username</th>
                      <th>Email</th>
                      <th>Mobile No.</th>
                      <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="adminTableBody"></tbody>
            </table>
          </div>
        </div>
        <div class="right_side m-1 rounded bg-info">
            <div class="container-fluid">
                <div class="card mt-3 shadow-sm">
                    <div class="card-header bg-primary text-dark">
                        <h5 class="mb-0">Admin Account Summary</h5>
                    </div>
                    <div class="card-body text-center">
                        <h5 class="fw-bold">Total Accounts</h5>
                        <h3 class="text-primary fw-bold"><span id="adminTotal">0</span></h3>
                        <div class="mt-1">
                            <div class="d-flex justify-content-between">
                                <p class="fw-bold text-success">Active:</p>
                                <p class="fw-bold text-success"><span id="adminActive">0</span></p>
                            </div>
                            <div class="d-flex justify-content-between">
                                <p class="fw-bold text-danger">Inactive:</p>
                                <p class="fw-bold text-danger"><span id="adminInactive">0</span></p>
                            </div>
                            <div>
                              <button class="btn btn-success" type="button" data-bs-toggle="modal" data-bs-target="#addSvAccModal">Add an Admin Account</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
      </div>

      <!-- Add Admin Account Modal -->
       <div class="modal fade" id="addSvAccModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addSvAccModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header bg-primary text-dark">
                <h1 class="modal-title fs-5" id="addSvAccModalLabel">Add an Admin Account</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form id="addAdminForm" method="POST" action="{{ url_for('admin.create_admin') }}">
                  <div class="card mb-4">
                    <div class="card-header bg-info text-dark">
                      <h5 class="mb-0 fw-bold">---</h5>
                    </div>
                    <div class="card-body bg-light">
                      <div class="row g-3">
                        <div class="col-md-6">
                          <label for="last_name" class="form-label fw-bold">Last Name <i class="text-danger">*</i></label>
                          <input type="text" class="form-control" id="last_name" name="last_name" placeholder="Enter last name" required>
                        </div>
                        <div class="col-md-6">
                          <label for="first_name" class="form-label fw-bold">First Name <i class="text-danger">*</i></label>
                          <input type="text" class="form-control" id="first_name" name="first_name" placeholder="Enter first name" required>
                        </div>
                        <div class="col-md-6">
                          <label for="birth_date" class="form-label fw-bold">Birth Date <i class="text-danger">*</i></label>
                          <input type="date" class="form-control" id="birth_date" name="birth_date" required>
                        </div>
                        <div class="col-md-6">
                          <label for="sex" class="form-label fw-bold">Sex <i class="text-danger">*</i></label>
                          <select class="form-select" id="sex" name="sex" required>
                            <option value="" disabled selected></option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                          </select>
                        </div>  
                        <div class="col-md-12">
                          <label for="role" class="form-label fw-bold">Role <i class="text-danger">*</i></label>
                          <input type="text" class="form-control" id="role" name="role" placeholder="Enter role" required>
                        </div>
                        <div class="col-md-12">
                          <label for="username" class="form-label fw-bold">Username <i class="text-danger">*</i></label>
                          <input type="text" class="form-control" id="admin_username" name="admin_username" placeholder="Enter username" required>
                        </div>
                        <div class="col-md-12">
                          <label for="password" class="form-label fw-bold">Password</label>
                          <div class="input-group">
                            <input type="password" class="form-control" id="admin_password" name="admin_password">
                            <button type="button" class="btn btn-outline-secondary rounded-end-2" id="toggleAdminPassword"><i class="bi bi-eye"></i></button>
                            <label class="form-label w-100"><span class="text-muted">If left empty, a default password (00000) will be generated.</span></label>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <label for="email" class="form-label fw-bold">Email <i class="text-danger">*</i></label>
                          <input type="email" class="form-control" id="email" name="email" placeholder="Enter email" required>
                        </div>
                        <div class="col-md-12">
                        <label for="mobile_no" class="form-label fw-bold">Mobile No. <i class="text-danger">*</i></label>
                        <input type="text" class="form-control" id="mobile_no" name="mobile_no" placeholder="Enter mobile number" required>
                      </div>
                      </div>
                    </div>
                  </div>
                  <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-lg text-dark">Submit</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal for updating a peso account -->
      <div class="modal fade" id="updateAdminModal" tabindex="-1" aria-labelledby="updateAdminModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header bg-primary text-dark">
              <h1 class="modal-title fs-5" id="updateAdminModalLabel">Update Admin Account</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="updateAdminForm" method="POST" action="{{ url_for('admin.update_admin') }}">
                <div class="modal-body">
                    <input type="hidden" id="update_admin_id" name="admin_id">
                    <div class="row g-3">
                    <div class="col-md-6">
                        <label for="update_admin_last_name" class="form-label fw-bold">Last Name</label>
                        <input type="text" class="form-control" id="update_admin_last_name" name="last_name" required>
                    </div>
                    <div class="col-md-6">
                        <label for="update_admin_first_name" class="form-label fw-bold">First Name</label>
                        <input type="text" class="form-control" id="update_admin_first_name" name="first_name" required>
                    </div>
                    <div class="col-md-6">
                        <label for="update_admin_birth_date" class="form-label fw-bold">Birth Date</label>
                        <input type="date" class="form-control" id="update_admin_birth_date" name="birth_date" required>
                    </div>
                    <div class="col-md-6">
                        <label for="update_admin_sex" class="form-label fw-bold">Sex</label>
                        <select class="form-select" id="update_admin_sex" name="sex" required>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        </select>
                    </div>
                    <div class="col-md-12">
                        <label for="update_admin_role" class="form-label fw-bold">Role</label>
                        <input type="text" class="form-control" id="update_admin_role" name="role" required>
                    </div>
                    <div class="col-md-12">
                        <label for="update_admin_username" class="form-label fw-bold">Username</label>
                        <input type="text" class="form-control" id="update_admin_username" name="username" readonly>
                    </div>
                    <div class="col-md-12">
                        <label for="update_admin_email" class="form-label fw-bold">Email</label>
                        <input type="email" class="form-control" id="update_admin_email" name="email" required>
                    </div>
                    <div class="col-md-12">
                        <label for="update_admin_mobile_no" class="form-label fw-bold">Mobile No.</label>
                        <input type="text" class="form-control" id="update_admin_mobile_no" name="mobile_no" required>
                    </div>
                    <div class="col-md-12">
                        <label for="update_admin_password" class="form-label fw-bold">New Password (leave blank to keep current)</label>
                        <div class="input-group">
                          <input type="password" class="form-control" id="update_admin_password" name="password">
                          <button type="button" class="btn btn-outline-secondary" id="toggleUpdateAdminPassword"><i class="bi bi-eye"></i></button>
                        </div>
                    </div>
                  </div>
                </div>
                <div class="text-center mb-3">
                    <button type="submit" class="btn btn-success btn-lg text-dark">Update</button>
                </div>
                </form>
          </div>
        </div>
      </div>
      
      <!-- Toast container -->
      <div aria-live="polite" aria-atomic="true" class="position-relative">
        <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 2000;">
          {% with messages = get_flashed_messages(with_categories=true) %}
            {% for category, message in messages %}
              <div id="msgToast" class="toast show align-items-center text-bg-{{ category }} border border-dark round-3 toast-blur-bg" role="alert" aria-live="assertive" aria-atomic="true" style="min-width: 200px; min-height: 40px; font-size: 1rem;">
                <div class="toast-header bg-dark text-light">
                  <img src="{{ url_for('static', filename='images/spes_logo.png') }}" class="rounded me-2" style="height: 30px; width: 30px;" alt="spes logo">
                  <strong class="me-auto">Admin Page:</strong>
                  <small>Admin accounts</small>
                  <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body text-dark">
                  {{ message }}
                </div>
              </div>
            {% endfor %}
          {% endwith %}
        </div>
      </div>
    <script src="{{ url_for('static', filename='admin_script.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>